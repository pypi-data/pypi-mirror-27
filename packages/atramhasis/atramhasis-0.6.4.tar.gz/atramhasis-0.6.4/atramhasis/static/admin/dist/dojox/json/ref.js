//>>built
define("dojox/json/ref","dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date/stamp dojox".split(" "),function(F,t,I,z,B,w){z.getObject("json",!0,w);return w.json.ref={resolveJson:function(f,h){function p(c,C,k,a,r,l,D){var b,A,e;k=q in c?c[q]:k;if(q in c||void 0!==k&&a)k=(s+k).replace(x,"$2$3");a=l||c;if(void 0!==k){w&&(c.__id=k);if(h.schemas&&!(c instanceof Array)&&(e=k.match(/^(.+\/)[^\.\[]*$/)))r=h.schemas[e[1]];if(n[k]&&c instanceof Array==n[k]instanceof Array)a=n[k],
delete a.$ref,delete a._loadObject,A=!0;else if(e=r&&r.prototype)m.prototype=e,a=new m;n[k]=a;u&&(u[k]=h.time)}for(;r;){if(e=r.properties)for(b in c){var y=e[b];y&&("date-time"==y.format&&"string"==typeof c[b])&&(c[b]=B.fromISOString(c[b]))}r=r["extends"]}r=c.length;for(b in c){if(b==r)break;if(c.hasOwnProperty(b)){e=c[b];if("object"==typeof e&&e&&!(e instanceof Date)&&"__parent"!=b){g=e[v]||t&&e[q];if(c!=d&&(!g||!e.__parent))e.__parent=D?D:a;if(g)if(delete c[b],l=g.toString().replace(/(#)([^\.\[])/,
"$1.$2").match(/(^([^\[]*\/)?[^#\.\[]*)#?([\.\[].*)?/),n[(s+g).replace(x,"$2$3")]?g=n[(s+g).replace(x,"$2$3")]:(g="$"==l[1]||"this"==l[1]||""==l[1]?f:n[(s+l[1]).replace(x,"$2$3")])&&l[3]&&l[3].replace(/(\[([^\]]+)\])|(\.?([^\.\[]+))/g,function(a,b,c,e,d){g=g&&g[c?c.replace(/[\"\'\\]/,""):d]}),g)e=g;else{if(!C){var E;E||d.push(a);E=!0;e=p(e,!1,e[v],!0,y);e._loadObject=h.loader}}else C||(e=p(e,d==c,void 0===k?void 0:H(k,b),!1,y,a!=c&&"object"==typeof a[b]&&a[b],c))}c[b]=e;if(a!=c&&!a.__isDirty&&(l=
a[b],a[b]=e,A&&e!==l&&!a._loadObject&&!("_"==b.charAt(0)&&"_"==b.charAt(1))&&"$ref"!=b&&!(e instanceof Date&&l instanceof Date&&e.getTime()==l.getTime())&&!("function"==typeof e&&"function"==typeof l&&e.toString()==l.toString())&&n.onUpdate))n.onUpdate(a,b,l,e)}}if(A&&(q in c||a instanceof Array))for(b in a){if(!a.__isDirty&&a.hasOwnProperty(b)&&!c.hasOwnProperty(b)&&!("_"==b.charAt(0)&&"_"==b.charAt(1))&&!(a instanceof Array&&isNaN(b))){if(n.onUpdate&&"_loadObject"!=b&&"_idAttr"!=b)n.onUpdate(a,
b,a[b],void 0);for(delete a[b];a instanceof Array&&a.length&&void 0===a[a.length-1];)a.length--}}else if(n.onLoad)n.onLoad(a);return a}h=h||{};var q=h.idAttribute||"id",v=this.refAttribute,t=h.idAsRef,s=h.idPrefix||"",w=h.assignAbsoluteIds,n=h.index||{},u=h.timeStamps,g,d=[],x=/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/,H=this._addProp,m=function(){};f&&"object"==typeof f&&(f=p(f,!1,h.defaultId,!0),p(d,!1));return f},fromJson:function(f,h){try{var p=eval("("+f+")")}catch(q){throw new SyntaxError("Invalid JSON string: "+
q.message+" parsing: "+f);}return p?this.resolveJson(p,h):p},toJson:function(f,h,p,q){function v(d,f,g){if("object"==typeof d&&d){if(d instanceof Date)return'"'+B.toISOString(d,{zulu:!0})+'"';var m=d.__id;if(m){if("#"!=f&&(z&&!m.match(/#/)||n[m]))return g=m,"#"!=m.charAt(0)&&(g=d.__clientId==m?"cid:"+m:m.substring(0,p.length)==p?m.substring(p.length):m),d={},d[G]=g,t.toJson(d,h);f=m}else d.__id=f,u[f]=d;n[f]=d;g=g||"";var c=h?g+t.toJsonIndentStr:"",q=h?"\n":"",m=h?" ":"";if(d instanceof Array)return"["+
F.map(d,function(a,b){var d=v(a,s(f,b),c);"string"!=typeof d&&(d="undefined");return q+c+d}).join(","+m)+q+g+"]";var k=[],a;for(a in d)if(d.hasOwnProperty(a)){var r;if("number"==typeof a)r='"'+a+'"';else if("string"==typeof a&&("_"!=a.charAt(0)||"_"!=a.charAt(1)))r=t._escapeString(a);else continue;var l=v(d[a],s(f,a),c);"string"==typeof l&&k.push(q+c+r+":"+m+l)}return"{"+k.join(","+m)+q+g+"}"}return"function"==typeof d&&w.json.ref.serializeFunctions?d.toString():t.toJson(d)}var z=this._useRefs,s=
this._addProp,G=this.refAttribute;p=p||"";var n={},u={};f=v(f,"#","");if(!q)for(var g in u)delete u[g].__id;return f},_addProp:function(f,h){return f+(f.match(/#/)?1==f.length?"":".":"#")+h},refAttribute:"$ref",_useRefs:!1,serializeFunctions:!1}});
//# sourceMappingURL=ref.js.map