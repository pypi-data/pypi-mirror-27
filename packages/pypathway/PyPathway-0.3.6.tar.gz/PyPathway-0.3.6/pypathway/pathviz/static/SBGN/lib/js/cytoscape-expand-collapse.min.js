(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.cytoscapeExpandCollapse=f()}})(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){var boundingBoxUtilities={equalBoundingBoxes:function(bb1,bb2){return bb1.x1==bb2.x1&&bb1.x2==bb2.x2&&bb1.y1==bb2.y1&&bb1.y2==bb2.y2;},getUnion:function(bb1,bb2){var union={x1:Math.min(bb1.x1,bb2.x1),x2:Math.max(bb1.x2,bb2.x2),y1:Math.min(bb1.y1,bb2.y1),y2:Math.max(bb1.y2,bb2.y2),};union.w=union.x2-union.x1;union.h=union.y2-union.y1;return union;}};module.exports=boundingBoxUtilities;},{}],2:[function(_dereq_,module,exports){var debounce=_dereq_('./debounce');module.exports=function(params){var fn=params;var eMouseOver,eMouseOut,ePosition,eRemove,eTap,eZoom,eAdd,eFree;var functions={init:function(){var self=this;var opts=params;var $container=this;var cy=this.cytoscape('get');var $canvas=$('<canvas></canvas>');$container.append($canvas);var _sizeCanvas=debounce(function(){$canvas.attr('height',$container.height()).attr('width',$container.width()).css({'position':'absolute','top':0,'left':0,'z-index':'999'});setTimeout(function(){var canvasBb=$canvas.offset();var containerBb=$container.offset();$canvas.css({'top':-(canvasBb.top-containerBb.top),'left':-(canvasBb.left-containerBb.left)});if(cy){clearDraws(true);}},0);},250);function sizeCanvas(){_sizeCanvas();}
sizeCanvas();$(window).bind('resize',function(){sizeCanvas();});var ctx=$canvas[0].getContext('2d');var data=$container.data('cyexpandcollapse');if(data==null){data={};}
data.options=opts;var optCache;function options(){return optCache||(optCache=$container.data('cyexpandcollapse').options);}
function clearDraws(keepExpandCues){var w=$container.width();var h=$container.height();ctx.clearRect(0,0,w,h);if(keepExpandCues){var collapsedNodes=cy.nodes('[expanded-collapsed="collapsed"]');for(var i=0;i<collapsedNodes.length;i++){drawExpandCollapseCue(collapsedNodes[i]);}}}
function clearNodeDraw(node){var x=node._private.data.expandcollapseRenderedStartX;var y=node._private.data.expandcollapseRenderedStartY;var s=node._private.data.expandcollapseRenderedCueSize;if(node.data('expanded-collapsed')==='collapsed'){drawExpandCollapseCue(node);}
ctx.clearRect(x,y,s,s);}
function drawExpandCollapseCue(node){var cy=node.cy();var children=node.children();var collapsedChildren=node._private.data.collapsedChildren;var hasChildren=children!=null&&children.length>0;if(!hasChildren&&collapsedChildren==null){return;}
var expandedOrcollapsed=node.data('expanded-collapsed');var rectSize=options().expandCollapseCueSize;var lineSize=options().expandCollapseCueLineSize;var diff;rectSize=rectSize*cy.zoom();lineSize=lineSize*cy.zoom();diff=(rectSize-lineSize)/2;var expandcollapseStartX;var expandcollapseStartY;var expandcollapseEndX;var expandcollapseEndY;var expandcollapseRectSize;var expandcollapseCenterX;var expandcollapseCenterY;if(options().expandCollapseCuePosition==='top-left'){var p=node.renderedPosition();var w=node.renderedOuterWidth();var h=node.renderedOuterHeight();expandcollapseCenterX=p.x-w/2-rectSize/4+rectSize/2;expandcollapseCenterY=p.y-h/2-rectSize/4+rectSize/2;}else{var option=options().expandCollapseCuePosition;var cueCenter=typeof option==='function'?option.call(this,node):option;var expandcollapseCenter=elementUtilities.convertToRenderedPosition(cueCenter);expandcollapseCenterX=expandcollapseCenter.x;expandcollapseCenterY=expandcollapseCenter.y;}
expandcollapseStartX=expandcollapseCenterX-rectSize/2;expandcollapseStartY=expandcollapseCenterY-rectSize/2;expandcollapseEndX=expandcollapseStartX+rectSize;expandcollapseEndY=expandcollapseStartY+rectSize;expandcollapseRectSize=rectSize;if(expandedOrcollapsed==='expanded'&&options().expandCueImage){var img=new Image();img.src=options().expandCueImage;ctx.drawImage(img,expandcollapseCenterX,expandcollapseCenterY,rectSize,rectSize);}
else if(expandedOrcollapsed==='collapsed'&&options().collapseCueImage){var img=new Image();img.src=options().collapseCueImage;ctx.drawImage(img,expandcollapseCenterX,expandcollapseCenterY,rectSize,rectSize);}
else{var oldFillStyle=ctx.fillStyle;var oldWidth=ctx.lineWidth;var oldStrokeStyle=ctx.strokeStyle;ctx.fillStyle="black";ctx.strokeStyle="black";ctx.ellipse(expandcollapseCenterX,expandcollapseCenterY,rectSize/2,rectSize/2,0,0,2*Math.PI);ctx.fill();ctx.beginPath();ctx.strokeStyle="white";ctx.lineWidth=2.6*cy.zoom();ctx.moveTo(expandcollapseStartX+diff,expandcollapseStartY+rectSize/2);ctx.lineTo(expandcollapseStartX+lineSize+diff,expandcollapseStartY+rectSize/2);if(expandedOrcollapsed=='collapsed'){ctx.moveTo(expandcollapseStartX+rectSize/2,expandcollapseStartY+diff);ctx.lineTo(expandcollapseStartX+rectSize/2,expandcollapseStartY+lineSize+diff);}
ctx.closePath();ctx.stroke();ctx.strokeStyle=oldStrokeStyle;ctx.fillStyle=oldFillStyle;ctx.lineWidth=oldWidth;}
node._private.data.expandcollapseRenderedStartX=expandcollapseStartX;node._private.data.expandcollapseRenderedStartY=expandcollapseStartY;node._private.data.expandcollapseRenderedCueSize=expandcollapseRectSize;}
$container.cytoscape(function(e){cy=this;clearDraws(true);cy.bind('zoom pan',eZoom=function(){clearDraws(true);});cy.on('mouseover','node',eMouseOver=function(e){var node=this;clearDraws(true);drawExpandCollapseCue(node);var lastPosition={};});cy.on('mouseout tapdragout','node',eMouseOut=function(e){clearDraws(true);});cy.on('position','node',ePosition=function(){var node=this;clearDraws(true);});cy.on('remove','node',eRemove=function(){var node=this;clearNodeDraw(node);});cy.on('add','node',eAdd=function(){var node=this;drawExpandCollapseCue(node);});cy.on('free','node',eFree=function(){var node=this;clearDraws(true);});var ur;cy.on('tap','node',eTap=function(event){var node=this;var expandcollapseRenderedStartX=node._private.data.expandcollapseRenderedStartX;var expandcollapseRenderedStartY=node._private.data.expandcollapseRenderedStartY;var expandcollapseRenderedRectSize=node._private.data.expandcollapseRenderedCueSize;var expandcollapseRenderedEndX=expandcollapseRenderedStartX+expandcollapseRenderedRectSize;var expandcollapseRenderedEndY=expandcollapseRenderedStartY+expandcollapseRenderedRectSize;var cyRenderedPosX=event.cyRenderedPosition.x;var cyRenderedPosY=event.cyRenderedPosition.y;var factor=(options().expandCollapseCueSensitivity-1)/2;if(cyRenderedPosX>=expandcollapseRenderedStartX-expandcollapseRenderedRectSize*factor&&cyRenderedPosX<=expandcollapseRenderedEndX+expandcollapseRenderedRectSize*factor&&cyRenderedPosY>=expandcollapseRenderedStartY-expandcollapseRenderedRectSize*factor&&cyRenderedPosY<=expandcollapseRenderedEndY+expandcollapseRenderedRectSize*factor){if(opts.undoable&&!ur)
ur=cy.undoRedo({defaultActions:false});if(node.isCollapsible())
if(opts.undoable)
ur.do("collapse",{nodes:node,options:opts});else
node.collapse(opts);else if(node.isExpandable())
if(opts.undoable)
ur.do("expand",{nodes:node,options:opts});else
node.expand(opts);}});});$container.data('cyexpandcollapse',data);},unbind:function(){var cy=this.cytoscape('get');cy.off('mouseover','node',eMouseOver).off('mouseout tapdragout','node',eMouseOut).off('position','node',ePosition).off('remove','node',eRemove).off('tap','node',eTap).off('add','node',eAdd).off('free','node',eFree);cy.unbind("zoom pan",eZoom);}};if(functions[fn]){return functions[fn].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof fn=='object'||!fn){return functions.init.apply(this,arguments);}else{$.error('No such function `'+fn+'` for cytoscape.js-expand-collapse');}
return $(this);};},{"./debounce":3}],3:[function(_dereq_,module,exports){var debounce=(function(){var FUNC_ERROR_TEXT='Expected a function';var nativeMax=Math.max,nativeNow=Date.now;var now=nativeNow||function(){return new Date().getTime();};function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=false,trailing=true;if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT);}
wait=wait<0?0:(+wait||0);if(options===true){var leading=true;trailing=false;}else if(isObject(options)){leading=!!options.leading;maxWait='maxWait'in options&&nativeMax(+options.maxWait||0,wait);trailing='trailing'in options?!!options.trailing:trailing;}
function cancel(){if(timeoutId){clearTimeout(timeoutId);}
if(maxTimeoutId){clearTimeout(maxTimeoutId);}
lastCalled=0;maxTimeoutId=timeoutId=trailingCall=undefined;}
function complete(isCalled,id){if(id){clearTimeout(id);}
maxTimeoutId=timeoutId=trailingCall=undefined;if(isCalled){lastCalled=now();result=func.apply(thisArg,args);if(!timeoutId&&!maxTimeoutId){args=thisArg=undefined;}}}
function delayed(){var remaining=wait-(now()-stamp);if(remaining<=0||remaining>wait){complete(trailingCall,maxTimeoutId);}else{timeoutId=setTimeout(delayed,remaining);}}
function maxDelayed(){complete(trailing,timeoutId);}
function debounced(){args=arguments;stamp=now();thisArg=this;trailingCall=trailing&&(timeoutId||!leading);if(maxWait===false){var leadingCall=leading&&!timeoutId;}else{if(!maxTimeoutId&&!leading){lastCalled=stamp;}
var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0||remaining>maxWait;if(isCalled){if(maxTimeoutId){maxTimeoutId=clearTimeout(maxTimeoutId);}
lastCalled=stamp;result=func.apply(thisArg,args);}
else if(!maxTimeoutId){maxTimeoutId=setTimeout(maxDelayed,remaining);}}
if(isCalled&&timeoutId){timeoutId=clearTimeout(timeoutId);}
else if(!timeoutId&&wait!==maxWait){timeoutId=setTimeout(delayed,wait);}
if(leadingCall){isCalled=true;result=func.apply(thisArg,args);}
if(isCalled&&!timeoutId&&!maxTimeoutId){args=thisArg=undefined;}
return result;}
debounced.cancel=cancel;return debounced;}
function isObject(value){var type=typeof value;return!!value&&(type=='object'||type=='function');}
return debounce;})();module.exports=debounce;},{}],4:[function(_dereq_,module,exports){function elementUtilities(cy){return{moveNodes:function(positionDiff,nodes,notCalcTopMostNodes){var topMostNodes=notCalcTopMostNodes?nodes:this.getTopMostNodes(nodes);for(var i=0;i<topMostNodes.length;i++){var node=topMostNodes[i];var oldX=node.position("x");var oldY=node.position("y");node.position({x:oldX+positionDiff.x,y:oldY+positionDiff.y});var children=node.children();this.moveNodes(positionDiff,children,true);}},getTopMostNodes:function(nodes){var nodesMap={};for(var i=0;i<nodes.length;i++){nodesMap[nodes[i].id()]=true;}
var roots=nodes.filter(function(i,ele){var parent=ele.parent()[0];while(parent!=null){if(nodesMap[parent.id()]){return false;}
parent=parent.parent()[0];}
return true;});return roots;},rearrange:function(layoutBy){if(typeof layoutBy==="function"){layoutBy();}else if(layoutBy!=null){cy.layout(layoutBy);}},convertToRenderedPosition:function(modelPosition){var pan=cy.pan();var zoom=cy.zoom();var x=modelPosition.x*zoom+pan.x;var y=modelPosition.y*zoom+pan.y;return{x:x,y:y};}};}
module.exports=elementUtilities;},{}],5:[function(_dereq_,module,exports){var boundingBoxUtilities=_dereq_('./boundingBoxUtilities');function expandCollapseUtilities(cy){var elementUtilities=_dereq_('./elementUtilities')(cy);return{animatedlyMovingNodeCount:0,expandNodeBaseFunction:function(node,triggerLayout,single,layoutBy){var positionDiff={x:node.position('x')-node.data('position-before-collapse').x,y:node.position('y')-node.data('position-before-collapse').y};node.removeData("infoLabel");node.data('expanded-collapsed','expanded');node.trigger("beforeExpand");node._private.data.collapsedChildren.restore();this.repairEdges(node);node._private.data.collapsedChildren=null;node.trigger("afterExpand");elementUtilities.moveNodes(positionDiff,node.children());node.removeData('position-before-collapse');if(single)
this.endOperation(layoutBy);},simpleCollapseGivenNodes:function(nodes){nodes.data("collapse",true);var roots=elementUtilities.getTopMostNodes(nodes);for(var i=0;i<roots.length;i++){var root=roots[i];this.collapseBottomUp(root);}
return nodes;},simpleExpandGivenNodes:function(nodes,applyFishEyeViewToEachNode){nodes.data("expand",true);var roots=elementUtilities.getTopMostNodes(nodes);for(var i=0;i<roots.length;i++){var root=roots[i];this.expandTopDown(root,applyFishEyeViewToEachNode);}
return nodes;},simpleExpandAllNodes:function(nodes,applyFishEyeViewToEachNode){if(nodes===undefined){nodes=cy.nodes();}
var orphans;orphans=elementUtilities.getTopMostNodes(nodes);var expandStack=[];for(var i=0;i<orphans.length;i++){var root=orphans[i];this.expandAllTopDown(root,expandStack,applyFishEyeViewToEachNode);}
return expandStack;},endOperation:function(layoutBy){var self=this;cy.ready(function(){elementUtilities.rearrange(layoutBy);});},expandAllNodes:function(nodes,options){var expandedStack=this.simpleExpandAllNodes(nodes,options.fisheye);this.endOperation(options.layoutBy);return expandedStack;},expandAllTopDown:function(root,expandStack,applyFishEyeViewToEachNode){if(root._private.data.collapsedChildren!=null){expandStack.push(root);this.simpleExpandNode(root,applyFishEyeViewToEachNode);}
var children=root.children();for(var i=0;i<children.length;i++){var node=children[i];this.expandAllTopDown(node,expandStack,applyFishEyeViewToEachNode);}},expandGivenNodes:function(nodes,options){if(nodes.length===1){this.expandNode(nodes[0],options.fisheye,options.animate,options.layoutBy);}else{this.simpleExpandGivenNodes(nodes,options.fisheye);this.endOperation(options.layoutBy);}
return nodes;},collapseGivenNodes:function(nodes,options){this.simpleCollapseGivenNodes(nodes,options);this.endOperation(options.layoutBy);return nodes;},collapseBottomUp:function(root){var children=root.children();for(var i=0;i<children.length;i++){var node=children[i];this.collapseBottomUp(node);}
if(root.data("collapse")&&root.children().length>0){this.simpleCollapseNode(root);root.removeData("collapse");}},expandTopDown:function(root,applyFishEyeViewToEachNode){if(root.data("expand")&&root._private.data.collapsedChildren!=null){this.simpleExpandNode(root,applyFishEyeViewToEachNode);root.removeData("expand");}
var children=root.children();for(var i=0;i<children.length;i++){var node=children[i];this.expandTopDown(node);}},expandNode:function(node,fisheye,animate,layoutBy){if(node._private.data.collapsedChildren!=null){this.simpleExpandNode(node,fisheye,true,animate,layoutBy);return node;}},convertToModelPosition:function(renderedPosition){var pan=cy.pan();var zoom=cy.zoom();var x=(renderedPosition.x-pan.x)/zoom;var y=(renderedPosition.y-pan.y)/zoom;return{x:x,y:y};},simpleExpandNode:function(node,applyFishEyeViewToEachNode,singleNotSimple,animate,layoutBy){var self=this;var commonExpandOperation=function(node,applyFishEyeViewToEachNode,singleNotSimple,animate,layoutBy){if(applyFishEyeViewToEachNode){node.data('width-before-fisheye',node.data('size-before-collapse').w);node.data('height-before-fisheye',node.data('size-before-collapse').h);self.fishEyeViewExpandGivenNode(node,singleNotSimple,node,animate,layoutBy);}
if(!singleNotSimple||!applyFishEyeViewToEachNode||!animate){self.expandNodeBaseFunction(node,singleNotSimple,singleNotSimple,layoutBy);}};if(node._private.data.collapsedChildren!=null){this.storeWidthHeight(node);if(applyFishEyeViewToEachNode&&singleNotSimple){var topLeftPosition=this.convertToModelPosition({x:0,y:0});var bottomRightPosition=this.convertToModelPosition({x:cy.width(),y:cy.height()});var padding=80;var bb={x1:topLeftPosition.x,x2:bottomRightPosition.x,y1:topLeftPosition.y,y2:bottomRightPosition.y};var nodeBB={x1:node.position('x')-node.data('size-before-collapse').w/2-padding,x2:node.position('x')+node.data('size-before-collapse').w/2+padding,y1:node.position('y')-node.data('size-before-collapse').h/2-padding,y2:node.position('y')+node.data('size-before-collapse').h/2+padding};var unionBB=boundingBoxUtilities.getUnion(nodeBB,bb);var animating=false;if(!boundingBoxUtilities.equalBoundingBoxes(unionBB,bb)){var viewPort=cy.getFitViewport(unionBB,10);var self=this;animating=animate;if(animate){cy.animate({pan:viewPort.pan,zoom:viewPort.zoom,complete:function(){commonExpandOperation(node,applyFishEyeViewToEachNode,singleNotSimple,animate,layoutBy);}},{duration:1000});}
else{cy.zoom(viewPort.zoom);cy.pan(viewPort.pan);}}
if(!animating){commonExpandOperation(node,applyFishEyeViewToEachNode,singleNotSimple,animate,layoutBy);}}
else{commonExpandOperation(node,applyFishEyeViewToEachNode,singleNotSimple,animate,layoutBy);}
return node;}},simpleCollapseNode:function(node){if(node._private.data.collapsedChildren==null){node.data('position-before-collapse',{x:node.position().x,y:node.position().y});node.data('size-before-collapse',{w:node.outerWidth(),h:node.outerHeight()});node.children().unselect();node.children().connectedEdges().unselect();node.data('expanded-collapsed','collapsed');var children=node.children();node.trigger("beforeCollapse");this.barrowEdgesOfcollapsedChildren(node);this.removeChildren(node,node);node.trigger("afterCollapse");node.position(node.data('position-before-collapse'));return node;}},storeWidthHeight:function(node){if(node!=null){node.data('x-before-fisheye',this.xPositionInParent(node));node.data('y-before-fisheye',this.yPositionInParent(node));node.data('width-before-fisheye',node.outerWidth());node.data('height-before-fisheye',node.outerHeight());if(node.parent()[0]!=null){this.storeWidthHeight(node.parent()[0]);}}},fishEyeViewExpandGivenNode:function(node,singleNotSimple,nodeToExpand,animate,layoutBy){var siblings=this.getSiblings(node);var x_a=this.xPositionInParent(node);var y_a=this.yPositionInParent(node);var d_x_left=Math.abs((node.data('width-before-fisheye')-node.outerWidth())/2);var d_x_right=Math.abs((node.data('width-before-fisheye')-node.outerWidth())/2);var d_y_upper=Math.abs((node.data('height-before-fisheye')-node.outerHeight())/2);var d_y_lower=Math.abs((node.data('height-before-fisheye')-node.outerHeight())/2);var abs_diff_on_x=Math.abs(node.data('x-before-fisheye')-x_a);var abs_diff_on_y=Math.abs(node.data('y-before-fisheye')-y_a);if(node.data('x-before-fisheye')>x_a){d_x_left=d_x_left+abs_diff_on_x;d_x_right=d_x_right-abs_diff_on_x;}
else{d_x_left=d_x_left-abs_diff_on_x;d_x_right=d_x_right+abs_diff_on_x;}
if(node.data('y-before-fisheye')>y_a){d_y_upper=d_y_upper+abs_diff_on_y;d_y_lower=d_y_lower-abs_diff_on_y;}
else{d_y_upper=d_y_upper-abs_diff_on_y;d_y_lower=d_y_lower+abs_diff_on_y;}
var xPosInParentSibling=[];var yPosInParentSibling=[];for(var i=0;i<siblings.length;i++){xPosInParentSibling.push(this.xPositionInParent(siblings[i]));yPosInParentSibling.push(this.yPositionInParent(siblings[i]));}
for(var i=0;i<siblings.length;i++){var sibling=siblings[i];var x_b=xPosInParentSibling[i];var y_b=yPosInParentSibling[i];var slope=(y_b-y_a)/(x_b-x_a);var d_x=0;var d_y=0;var T_x=0;var T_y=0;if(x_a>x_b){d_x=d_x_left;}
else{d_x=d_x_right;}
if(y_a>y_b){d_y=d_y_upper;}
else{d_y=d_y_lower;}
if(isFinite(slope)){T_x=Math.min(d_x,(d_y/Math.abs(slope)));}
if(slope!==0){T_y=Math.min(d_y,(d_x*Math.abs(slope)));}
if(x_a>x_b){T_x=-1*T_x;}
if(y_a>y_b){T_y=-1*T_y;}
this.fishEyeViewMoveNode(sibling,T_x,T_y,nodeToExpand,singleNotSimple,animate,layoutBy);}
if(siblings.length==0){this.expandNodeBaseFunction(nodeToExpand,singleNotSimple,true,layoutBy);}
if(node.parent()[0]!=null){this.fishEyeViewExpandGivenNode(node.parent()[0],singleNotSimple,nodeToExpand,animate,layoutBy);}
return node;},getSiblings:function(node){var siblings;if(node.parent()[0]==null){siblings=cy.collection();var orphans=cy.nodes().orphans();for(var i=0;i<orphans.length;i++){if(orphans[i]!=node){siblings=siblings.add(orphans[i]);}}}else{siblings=node.siblings();}
return siblings;},fishEyeViewMoveNode:function(node,T_x,T_y,nodeToExpand,singleNotSimple,animate,layoutBy){var childrenList=node.children();var self=this;if(childrenList.length==0){var newPosition={x:node.position('x')+T_x,y:node.position('y')+T_y};if(!singleNotSimple||!animate){node.position(newPosition);}
else{this.animatedlyMovingNodeCount++;node.animate({position:newPosition,complete:function(){self.animatedlyMovingNodeCount--;if(self.animatedlyMovingNodeCount>0||nodeToExpand.data('expanded-collapsed')==='expanded'){return;}
self.expandNodeBaseFunction(nodeToExpand,singleNotSimple,true,layoutBy);}},{duration:1000});}}
else{for(var i=0;i<childrenList.length;i++){this.fishEyeViewMoveNode(childrenList[i],T_x,T_y,nodeToExpand,singleNotSimple,animate,layoutBy);}}},xPositionInParent:function(node){var parent=node.parent()[0];var x_a=0.0;if(parent!=null){x_a=node.relativePosition('x')+(parent.width()/2);}
else{x_a=node.position('x');}
return x_a;},yPositionInParent:function(node){var parent=node.parent()[0];var y_a=0.0;if(parent!=null){y_a=node.relativePosition('y')+(parent.height()/2);}
else{y_a=node.position('y');}
return y_a;},removeChildren:function(node,root){var children=node.children();for(var i=0;i<children.length;i++){var child=children[i];this.removeChildren(child,root);var removedChild=child.remove();if(root._private.data.collapsedChildren==null){root._private.data.collapsedChildren=removedChild;}
else{root._private.data.collapsedChildren=root._private.data.collapsedChildren.union(removedChild);}}},isMetaEdge:function(edge){return edge.hasClass("meta");},barrowEdgesOfcollapsedChildren:function(node){var relatedNodes=node.descendants();var edges=relatedNodes.edgesWith(cy.nodes().not(relatedNodes.union(node)));var relatedNodeMap={};relatedNodes.each(function(i,ele){relatedNodeMap[ele.id()]=true;});for(var i=0;i<edges.length;i++){var edge=edges[i];var source=edge.source();var target=edge.target();if(!this.isMetaEdge(edge)){var originalEndsData={source:source,target:target};edge.addClass("meta");edge.data('originalEnds',originalEndsData);}
edge.move({target:!relatedNodeMap[target.id()]?target.id():node.id(),source:!relatedNodeMap[source.id()]?source.id():node.id()});}},findNewEnd:function(node){var current=node;while(!current.inside()){current=current.parent();}
return current;},repairEdges:function(node){var connectedMetaEdges=node.connectedEdges('.meta');for(var i=0;i<connectedMetaEdges.length;i++){var edge=connectedMetaEdges[i];var originalEnds=edge.data('originalEnds');var currentSrcId=edge.data('source');var currentTgtId=edge.data('target');if(currentSrcId===node.id()){edge=edge.move({source:this.findNewEnd(originalEnds.source).id()});}else{edge=edge.move({target:this.findNewEnd(originalEnds.target).id()});}
if(edge.data('source')===originalEnds.source.id()&&edge.data('target')===originalEnds.target.id()){edge.removeClass('meta');edge.removeData('originalEnds');}}},isOuterNode:function(node,root){var temp=node;while(temp!=null){if(temp==root){return false;}
temp=temp.parent()[0];}
return true;}}};module.exports=expandCollapseUtilities;},{"./boundingBoxUtilities":1,"./elementUtilities":4}],6:[function(_dereq_,module,exports){;(function($$,$){'use strict';var register=function(cytoscape,$){if(!cytoscape){return;}
var expandCollapseUtilities=_dereq_('./expandCollapseUtilities');var undoRedoUtilities=_dereq_('./undoRedoUtilities');var elementUtilities=_dereq_('./elementUtilities');$.fn.cytoscapeExpandCollapse=_dereq_("./cueUtilities");var options={layoutBy:null,fisheye:true,animate:true,ready:function(){},undoable:true,cueEnabled:true,expandCollapseCuePosition:'top-left',expandCollapseCueSize:12,expandCollapseCueLineSize:8,expandCueImage:undefined,collapseCueImage:undefined,expandCollapseCueSensitivity:1};function setOptions(from){var tempOpts={};for(var key in options)
tempOpts[key]=options[key];for(var key in from)
if(tempOpts.hasOwnProperty(key))
tempOpts[key]=from[key];return tempOpts;}
function evalOptions(options){var animate=typeof options.animate==='function'?options.animate.call():options.animate;var fisheye=typeof options.fisheye==='function'?options.fisheye.call():options.fisheye;options.animate=animate;options.fisheye=fisheye;}
cytoscape("core","expandCollapse",function(opts){var cy=this;options=setOptions(opts);cy.nodes(':parent').data('expanded-collapsed','expanded');undoRedoUtilities(cy);if(options.cueEnabled)
$(cy.container()).cytoscapeExpandCollapse(options);else
$(cy.container()).cytoscapeExpandCollapse("unbind");options.ready();return cy;});cytoscape("core","setExpandCollapseOptions",function(opts){options=opts;});cytoscape("core","setExpandCollapseOption",function(name,value){options[name]=value;});cytoscape('collection','collapse',function(opts){var eles=this.collapsibleNodes();var tempOptions=setOptions(opts);evalOptions(tempOptions);return expandCollapseUtilities(this.cy()).collapseGivenNodes(eles,tempOptions);});cytoscape('collection','collapseRecursively',function(opts){var eles=this.collapsibleNodes();var tempOptions=setOptions(opts);evalOptions(tempOptions);return eles.union(eles.descendants()).collapse(tempOptions);});cytoscape('collection','expand',function(opts){var eles=this.expandableNodes();var tempOptions=setOptions(opts);evalOptions(tempOptions);return expandCollapseUtilities(this.cy()).expandGivenNodes(eles,tempOptions);});cytoscape('collection','expandRecursively',function(opts){var eles=this.expandableNodes();var tempOptions=setOptions(opts);evalOptions(tempOptions);return expandCollapseUtilities(this.cy()).expandAllNodes(eles,tempOptions);});cytoscape('core','collapseAll',function(opts){var cy=this;var tempOptions=setOptions(opts);evalOptions(tempOptions);return cy.collapsibleNodes().collapseRecursively(tempOptions);});cytoscape('core','expandAll',function(opts){var cy=this;var tempOptions=setOptions(opts);evalOptions(tempOptions);return cy.expandableNodes().expandRecursively(tempOptions);});cytoscape('collection','isExpandable',function(){var ele=this;return(ele.data("expanded-collapsed")==="collapsed");});cytoscape('collection','isCollapsible',function(){var ele=this;return!ele.isExpandable()&&ele.isParent();});cytoscape('collection','collapsibleNodes',function(){var eles=this;return eles.filter(function(i,ele){return ele.isCollapsible();});});cytoscape('collection','expandableNodes',function(){var eles=this;return eles.filter(function(i,ele){return ele.isExpandable();});});cytoscape('core','collapsibleNodes',function(){var cy=this;return cy.nodes().collapsibleNodes();});cytoscape('core','expandableNodes',function(){var cy=this;return cy.nodes().expandableNodes();});};if(typeof module!=='undefined'&&module.exports){module.exports=register;}
if(typeof define!=='undefined'&&define.amd){define('cytoscape-expand-collapse',function(){return register;});}
if(typeof cytoscape!=='undefined'&&typeof jQuery!=='undefined'){register(cytoscape,jQuery);}})();},{"./cueUtilities":2,"./elementUtilities":4,"./expandCollapseUtilities":5,"./undoRedoUtilities":7}],7:[function(_dereq_,module,exports){module.exports=function(cy){if(cy.undoRedo==null)
return;var ur=cy.undoRedo({},true);function getEles(_eles){return(typeof _eles==="string")?cy.$(_eles):_eles;}
function getNodePositionsAndSizes(){var positionsAndSizes={};var nodes=cy.nodes();for(var i=0;i<nodes.length;i++){var ele=nodes[i];positionsAndSizes[ele.id()]={width:ele.width(),height:ele.height(),x:ele.position("x"),y:ele.position("y")};}
return positionsAndSizes;}
function returnToPositionsAndSizes(nodesData){var currentPositionsAndSizes={};cy.nodes().positions(function(i,ele){currentPositionsAndSizes[ele.id()]={width:ele.width(),height:ele.height(),x:ele.position("x"),y:ele.position("y")};var data=nodesData[ele.id()];ele._private.data.width=data.width;ele._private.data.height=data.height;return{x:data.x,y:data.y};});return currentPositionsAndSizes;}
var secondTimeOpts={layoutBy:null,animate:false,fisheye:false};function doIt(func){return function(args){var result={};var nodes=getEles(args.nodes);if(args.firstTime){result.oldData=getNodePositionsAndSizes();result.nodes=func.indexOf("All")>0?cy[func](args.options):nodes[func](args.options);}else{result.oldData=getNodePositionsAndSizes();result.nodes=func.indexOf("All")>0?cy[func](secondTimeOpts):cy.collection(nodes)[func](secondTimeOpts);returnToPositionsAndSizes(args.oldData);}
return result;};}
var actions=["collapse","collapseRecursively","collapseAll","expand","expandRecursively","expandAll"];for(var i=0;i<actions.length;i++){ur.action(actions[i],doIt(actions[i]),doIt(actions[(i+3)%6]));}};},{}]},{},[6])(6)});
