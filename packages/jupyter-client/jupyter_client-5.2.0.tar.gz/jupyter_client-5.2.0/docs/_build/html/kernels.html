

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Making kernels for Jupyter &mdash; jupyter_client 5.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="jupyter_client 5.1.0 documentation" href="index.html"/>
        <link rel="next" title="Making simple Python wrapper kernels" href="wrapperkernels.html"/>
        <link rel="prev" title="Messaging in Jupyter" href="messaging.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> jupyter_client
          

          
          </a>

          
            
            
              <div class="version">
                5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="messaging.html">Messaging in Jupyter</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Making kernels for Jupyter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#connection-files">Connection files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handling-messages">Handling messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kernel-specs">Kernel specs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="wrapperkernels.html">Making simple Python wrapper kernels</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">jupyter_client API</a></li>
</ul>
<p class="caption"><span class="caption-text">Changes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changes in Jupyter Client</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">jupyter_client</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Making kernels for Jupyter</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/kernels.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="making-kernels-for-jupyter">
<span id="kernels"></span><h1>Making kernels for Jupyter<a class="headerlink" href="#making-kernels-for-jupyter" title="Permalink to this headline">¶</a></h1>
<p>A &#8216;kernel&#8217; is a program that runs and introspects the user&#8217;s code. IPython
includes a kernel for Python code, and people have written kernels for
<a class="reference external" href="https://github.com/jupyter/jupyter/wiki/Jupyter-kernels">several other languages</a>.</p>
<p>When Jupyter starts a kernel, it passes it a connection file. This specifies
how to set up communications with the frontend.</p>
<p>There are two options for writing a kernel:</p>
<ol class="arabic simple">
<li>You can reuse the IPython kernel machinery to handle the communications, and
just describe how to execute your code. This is much simpler if the target
language can be driven from Python. See <a class="reference internal" href="wrapperkernels.html"><span class="doc">Making simple Python wrapper kernels</span></a> for details.</li>
<li>You can implement the kernel machinery in your target language. This is more
work initially, but the people using your kernel might be more likely to
contribute to it if it&#8217;s in the language they know.</li>
</ol>
<div class="section" id="connection-files">
<h2>Connection files<a class="headerlink" href="#connection-files" title="Permalink to this headline">¶</a></h2>
<p>Your kernel will be given the path to a connection file when it starts (see
<a class="reference internal" href="#kernelspecs"><span class="std std-ref">Kernel specs</span></a> for how to specify the command line arguments for your kernel).
This file, which is accessible only to the current user, will contain a JSON
dictionary looking something like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;control_port&quot;</span><span class="p">:</span> <span class="mi">50160</span><span class="p">,</span>
  <span class="s2">&quot;shell_port&quot;</span><span class="p">:</span> <span class="mi">57503</span><span class="p">,</span>
  <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;tcp&quot;</span><span class="p">,</span>
  <span class="s2">&quot;signature_scheme&quot;</span><span class="p">:</span> <span class="s2">&quot;hmac-sha256&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stdin_port&quot;</span><span class="p">:</span> <span class="mi">52597</span><span class="p">,</span>
  <span class="s2">&quot;hb_port&quot;</span><span class="p">:</span> <span class="mi">42540</span><span class="p">,</span>
  <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;iopub_port&quot;</span><span class="p">:</span> <span class="mi">40885</span><span class="p">,</span>
  <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;a0436f6c-1916-498b-8eb9-e81ab9368e84&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">transport</span></code>, <code class="docutils literal"><span class="pre">ip</span></code> and five <code class="docutils literal"><span class="pre">_port</span></code> fields specify five ports which the
kernel should bind to using <a class="reference external" href="http://zeromq.org/">ZeroMQ</a>. For instance, the
address of the shell socket in the example above would be:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tcp</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">57503</span>
</pre></div>
</div>
<p>New ports are chosen at random for each kernel started.</p>
<p><code class="docutils literal"><span class="pre">signature_scheme</span></code> and <code class="docutils literal"><span class="pre">key</span></code> are used to cryptographically sign messages, so
that other users on the system can&#8217;t send code to run in this kernel. See
<a class="reference internal" href="messaging.html#wire-protocol"><span class="std std-ref">The Wire Protocol</span></a> for the details of how this signature is calculated.</p>
</div>
<div class="section" id="handling-messages">
<h2>Handling messages<a class="headerlink" href="#handling-messages" title="Permalink to this headline">¶</a></h2>
<p>After reading the connection file and binding to the necessary sockets, the
kernel should go into an event loop, listening on the hb (heartbeat), control
and shell sockets.</p>
<p><a class="reference internal" href="messaging.html#kernel-heartbeat"><span class="std std-ref">Heartbeat</span></a> messages should be echoed back immediately
on the same socket - the frontend uses this to check that the kernel is still
alive.</p>
<p>Messages on the control and shell sockets should be parsed, and their signature
validated. See <a class="reference internal" href="messaging.html#wire-protocol"><span class="std std-ref">The Wire Protocol</span></a> for how to do this.</p>
<p>The kernel will send messages on the iopub socket to display output, and on the
stdin socket to prompt the user for textual input.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="messaging.html"><span class="doc">Messaging in Jupyter</span></a></dt>
<dd>Details of the different sockets and the messages that come over them</dd>
<dt><a class="reference external" href="http://andrew.gibiansky.com/blog/ipython/ipython-kernels/">Creating Language Kernels for IPython</a></dt>
<dd>A blog post by the author of <a class="reference external" href="https://github.com/gibiansky/IHaskell">IHaskell</a>,
a Haskell kernel</dd>
<dt><a class="reference external" href="https://github.com/dsblank/simple_kernel">simple_kernel</a></dt>
<dd>A simple example implementation of the kernel machinery in Python</dd>
</dl>
</div>
</div>
<div class="section" id="kernel-specs">
<span id="kernelspecs"></span><h2>Kernel specs<a class="headerlink" href="#kernel-specs" title="Permalink to this headline">¶</a></h2>
<p>A kernel identifies itself to IPython by creating a directory, the name of which
is used as an identifier for the kernel. These may be created in a number of
locations:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="51%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&nbsp;</th>
<th class="head">Unix</th>
<th class="head">Windows</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>System</td>
<td><p class="first"><code class="docutils literal"><span class="pre">/usr/share/jupyter/kernels</span></code></p>
<p class="last"><code class="docutils literal"><span class="pre">/usr/local/share/jupyter/kernels</span></code></p>
</td>
<td><code class="docutils literal"><span class="pre">%PROGRAMDATA%\jupyter\kernels</span></code></td>
</tr>
<tr class="row-odd"><td>Env</td>
<td colspan="2"><code class="docutils literal"><span class="pre">{sys.prefix}/share/jupyter/kernels</span></code></td>
</tr>
<tr class="row-even"><td>User</td>
<td><p class="first"><code class="docutils literal"><span class="pre">~/.local/share/jupyter/kernels</span></code> (Linux)</p>
<p class="last"><code class="docutils literal"><span class="pre">~/Library/Jupyter/kernels</span></code> (Mac)</p>
</td>
<td><code class="docutils literal"><span class="pre">%APPDATA%\jupyter\kernels</span></code></td>
</tr>
</tbody>
</table>
<p>The user location takes priority over the system locations, and the case of the
names is ignored, so selecting kernels works the same way whether or not the
filesystem is case sensitive.
Since kernelspecs show up in URLs and other places,
a kernelspec is required to have a simple name, only containing ASCII letters, ASCII numbers, and the simple separators: <code class="docutils literal"><span class="pre">-</span></code> hyphen, <code class="docutils literal"><span class="pre">.</span></code> period, <code class="docutils literal"><span class="pre">_</span></code> underscore.</p>
<p>Other locations may also be searched if the <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal"><span class="pre">JUPYTER_PATH</span></code> environment
variable is set.</p>
<p>Inside the kernel directory, three types of files are presently used:
<code class="docutils literal"><span class="pre">kernel.json</span></code>, <code class="docutils literal"><span class="pre">kernel.js</span></code>, and logo image files. Currently, no other
files are used, but this may change in the future.</p>
<p>Inside the directory, the most important file is <em>kernel.json</em>. This should be a
JSON serialised dictionary containing the following keys and values:</p>
<ul class="simple">
<li><strong>argv</strong>: A list of command line arguments used to start the kernel. The text
<code class="docutils literal"><span class="pre">{connection_file}</span></code> in any argument will be replaced with the path to the
connection file.</li>
<li><strong>display_name</strong>: The kernel&#8217;s name as it should be displayed in the UI.
Unlike the kernel name used in the API, this can contain arbitrary unicode
characters.</li>
<li><strong>language</strong>: The name of the language of the kernel.
When loading notebooks, if no matching kernelspec key (may differ across machines)
is found, a kernel with a matching <cite>language</cite> will be used.
This allows a notebook written on any Python or Julia kernel to be properly associated
with the user&#8217;s Python or Julia kernel, even if they aren&#8217;t listed under the same name as the author&#8217;s.</li>
<li><strong>interrupt_mode</strong> (optional): May be either <code class="docutils literal"><span class="pre">signal</span></code> or <code class="docutils literal"><span class="pre">message</span></code> and
specifies how a client is supposed to interrupt cell execution on this kernel,
either by sending an interrupt <code class="docutils literal"><span class="pre">signal</span></code> via the operating system&#8217;s
signalling facilities (e.g. <cite>SIGINT</cite> on POSIX systems), or by sending an
<code class="docutils literal"><span class="pre">interrupt_request</span></code> message on the control channel (see
<a class="reference internal" href="messaging.html#msging-interrupt"><span class="std std-ref">Kernel interrupt</span></a>). If this is not specified
the client will default to <code class="docutils literal"><span class="pre">signal</span></code> mode.</li>
<li><strong>env</strong> (optional): A dictionary of environment variables to set for the kernel.
These will be added to the current environment variables before the kernel is
started.</li>
<li><strong>metadata</strong> (optional): A dictionary of additional attributes about this
kernel; used by clients to aid clients in kernel selection. Metadata added
here should be namespaced for the tool reading and writing that metadata.</li>
</ul>
<p>For example, the kernel.json file for IPython looks like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;argv&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;python3&quot;</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;IPython.kernel&quot;</span><span class="p">,</span>
          <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{connection_file}</span><span class="s2">&quot;</span><span class="p">],</span>
 <span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Python 3&quot;</span><span class="p">,</span>
 <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;python&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To see the available kernel specs, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">jupyter</span> <span class="n">kernelspec</span> <span class="nb">list</span>
</pre></div>
</div>
<p>To start the terminal console or the Qt console with a specific kernel:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">jupyter</span> <span class="n">console</span> <span class="o">--</span><span class="n">kernel</span> <span class="n">bash</span>
<span class="n">jupyter</span> <span class="n">qtconsole</span> <span class="o">--</span><span class="n">kernel</span> <span class="n">bash</span>
</pre></div>
</div>
<p>The notebook offers you the available kernels in a dropdown menu from the &#8216;New&#8217;
button.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="wrapperkernels.html" class="btn btn-neutral float-right" title="Making simple Python wrapper kernels" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="messaging.html" class="btn btn-neutral" title="Messaging in Jupyter" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Jupyter Development Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'5.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>