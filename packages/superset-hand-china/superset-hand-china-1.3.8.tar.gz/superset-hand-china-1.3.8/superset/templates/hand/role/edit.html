{% extends "appbuilder/general/model/add.html" %} {%block navbar%} {%endblock%} {% block body %}
<HTML>

<HEAD>
    <script src="/static/assets/resources/role/js/jquery-2.1.1.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        let user_ids;
        $(document).ready(function () {
            
            const users = JSON.parse($('#users').attr('data'));
            const current_users = JSON.parse($('#current_users').attr('data'));

            user_ids = $(".js-example-basic-multiple").select2();
            $.each(users, function (index, user) {
                $('#userId').append('<option value="' + user.id + '">' + user.text + '</option>');
                // $.each(current_users, function (i, current_user){
                //     if (current_user.id === user.id) {
                        
                //         // user_ids.val(current_user.id).trigger("change");
                //         user_ids.val()
                //     }
                // });
            });
            user_ids.val(current_users).trigger('change')
        });

        function doSubmit() {//回调函数，在编辑和保存动作时，供openDialog调用提交表单。
            $("#userIds").val(user_ids.val())
            $("#inputForm").submit();
            return true;
        }

    </script>
</HEAD>

<BODY>

    <form id="inputForm" class="form-horizontal" action="/hand/roles/edits" method="post">

        <table class="table table-bordered no-footer">
            <tbody>
                <tr style="height: 50px">
                    <td class="width-15 active"><label class="pull-right">{{ _("Role Name:") }}</label></td>
                    <td class="width-35">
                        <input style="width: 248px;" required id="roleName" name="roleName" value="{{ role.name }}" class="form-control" type="text" maxlength="50" aria-required="true"
                    aria-invalid="false">
                    </td>
                        <input name="roleId" type="hidden" value="{{ role.id }}" />
                    </td>
                </tr>
                <tr style="height: 50px">
                    <td class="width-15"><label class="pull-right">{{ _("User:") }}</label></td>
                    <td class="width-35">
                        <select style="width: 248px;" class="js-example-basic-multiple" id="userId" multiple=”multiple” name="userId"></select>
                        <input type="hidden" id="userIds" name="userIds" />
                    </td>
                </tr>

            </tbody>
        </table>
    </form>
<div id="users" data="{{users}}"> </div>
<div id="current_users" data="{{current_users}}"></div>
</BODY>

</HTML>
{%endblock%}